<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download MedWave App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 50px;
            padding-top: 40px;
        }

        .header h1 {
            font-size: 48px;
            font-weight: 700;
            margin-bottom: 16px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .header p {
            font-size: 20px;
            opacity: 0.95;
            font-weight: 300;
        }

        .download-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 70px rgba(0,0,0,0.4);
        }

        .card-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 20px;
            font-size: 40px;
        }

        .ios-icon {
            background: linear-gradient(135deg, #007AFF 0%, #0051D5 100%);
        }

        .android-icon {
            background: linear-gradient(135deg, #3DDC84 0%, #00C853 100%);
        }

        .card h2 {
            font-size: 28px;
            margin-bottom: 16px;
            color: #1a1a1a;
            text-align: center;
        }

        .card p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 24px;
            text-align: center;
        }

        .download-btn {
            display: block;
            width: 100%;
            padding: 18px 32px;
            text-decoration: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            margin-bottom: 16px;
        }

        .ios-btn {
            background: linear-gradient(135deg, #007AFF 0%, #0051D5 100%);
            color: white;
        }

        .ios-btn:hover {
            background: linear-gradient(135deg, #0051D5 0%, #003DA5 100%);
            transform: scale(1.02);
        }

        .android-btn {
            background: linear-gradient(135deg, #3DDC84 0%, #00C853 100%);
            color: white;
        }

        .android-btn:hover {
            background: linear-gradient(135deg, #00C853 0%, #00A843 100%);
            transform: scale(1.02);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            animation: slideUp 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            margin-bottom: 24px;
        }

        .modal-header h2 {
            font-size: 28px;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .modal-header p {
            color: #666;
            font-size: 16px;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #1a1a1a;
            font-weight: 600;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .form-group input.error {
            border-color: #dc3545;
        }

        .error-message {
            color: #dc3545;
            font-size: 14px;
            margin-top: 4px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        .modal-btn {
            flex: 1;
            padding: 14px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .modal-btn-primary:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .modal-btn-primary:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .modal-btn-secondary {
            background: #f0f0f0;
            color: #666;
        }

        .modal-btn-secondary:hover {
            background: #e0e0e0;
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 28px;
            color: #999;
            cursor: pointer;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .close-modal:hover {
            background: #f0f0f0;
            color: #333;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            text-align: center;
            padding: 20px;
        }

        .success-icon {
            font-size: 64px;
            margin-bottom: 16px;
        }

        .success-message h3 {
            color: #28a745;
            margin-bottom: 12px;
            font-size: 24px;
        }

        .success-message p {
            color: #666;
            line-height: 1.6;
        }

        .instructions {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .instructions h3 {
            font-size: 24px;
            margin-bottom: 20px;
            color: #1a1a1a;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .tab-container {
            display: flex;
            gap: 16px;
            margin-bottom: 32px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .step {
            margin-bottom: 24px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 4px solid #667eea;
        }

        .step-number {
            display: inline-block;
            width: 32px;
            height: 32px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 32px;
            font-weight: 700;
            margin-right: 12px;
        }

        .step h4 {
            display: inline-block;
            font-size: 18px;
            color: #1a1a1a;
            margin-bottom: 8px;
        }

        .step p {
            color: #666;
            line-height: 1.6;
            margin-left: 44px;
            margin-top: 8px;
        }

        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 20px;
            border-radius: 12px;
            margin: 24px 0;
        }

        .warning h4 {
            color: #856404;
            margin-bottom: 12px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning ul {
            margin-left: 20px;
            color: #856404;
        }

        .warning li {
            margin-bottom: 8px;
        }

        .info-box {
            background: #e3f2fd;
            border: 2px solid #2196F3;
            padding: 20px;
            border-radius: 12px;
            margin: 24px 0;
        }

        .info-box h4 {
            color: #0d47a1;
            margin-bottom: 12px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box p {
            color: #0d47a1;
            line-height: 1.6;
        }

        .app-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }

        .info-item {
            background: #f8f9fa;
            padding: 16px;
            border-radius: 8px;
            text-align: center;
        }

        .info-item strong {
            display: block;
            color: #667eea;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .info-item span {
            color: #1a1a1a;
            font-size: 16px;
        }

        .footer {
            text-align: center;
            color: white;
            padding: 40px 0;
            margin-top: 50px;
        }

        .footer p {
            opacity: 0.9;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 32px;
            }

            .header p {
                font-size: 16px;
            }

            .download-cards {
                grid-template-columns: 1fr;
            }

            .card {
                padding: 30px 20px;
            }

            .instructions {
                padding: 24px 16px;
            }

            .tab-container {
                flex-direction: column;
                gap: 8px;
            }

            .tab {
                border-bottom: none;
                border-left: 3px solid transparent;
            }

            .tab.active {
                border-bottom: none;
                border-left-color: #667eea;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• Download MedWave App</h1>
            <p>Advanced wound care management for healthcare professionals</p>
        </div>

        <div class="download-cards">
            <!-- iOS Card -->
            <div class="card">
                <div class="card-icon ios-icon">
                    
                </div>
                <h2>iOS (iPhone & iPad)</h2>
                <p>Request access to MedWave via TestFlight. We'll send you an invitation to join our beta testing program.</p>
                <button onclick="showIOSForm()" class="download-btn ios-btn">
                     Request TestFlight Access
                </button>
                <p style="font-size: 14px; color: #999;">Requires iOS 12.0 or later</p>
            </div>

            <!-- Android Card -->
            <div class="card">
                <div class="card-icon android-icon">
                    ü§ñ
                </div>
                <h2>Android</h2>
                <p>Download the APK file directly to your Android device. Easy installation in just a few steps.</p>
                <button onclick="showAndroidInstructions()" class="download-btn android-btn">
                    üì± Download APK
                </button>
                <p style="font-size: 14px; color: #999;">Requires Android 5.0 or later</p>
            </div>
        </div>

        <!-- App Information -->
        <div class="instructions">
            <h3>üìã App Information</h3>
            <div class="app-info">
                <div class="info-item">
                    <strong>Version</strong>
                    <span>1.2.12 (Build 14)</span>
                </div>
                <div class="info-item">
                    <strong>Android File Size</strong>
                    <span>~65 MB</span>
                </div>
                <div class="info-item">
                    <strong>Last Updated</strong>
                    <span>October 17, 2025</span>
                </div>
                <div class="info-item">
                    <strong>Platform</strong>
                    <span>iOS & Android</span>
                </div>
            </div>
        </div>

        <!-- Installation Instructions -->
        <div class="instructions">
            <h3>üìñ Installation Instructions</h3>
            
            <div class="tab-container">
                <button class="tab active" onclick="showTab('ios')">iOS (TestFlight)</button>
                <button class="tab" onclick="showTab('android')">Android (APK)</button>
            </div>

            <!-- iOS Instructions -->
            <div id="ios-instructions" class="tab-content active">
                <div class="info-box">
                    <h4>‚ÑπÔ∏è What is TestFlight?</h4>
                    <p>TestFlight is Apple's official app for beta testing iOS applications. It's safe, secure, and approved by Apple. You'll need to install TestFlight first, then use our invite link to access MedWave.</p>
                </div>

                <div class="step">
                    <span class="step-number">1</span>
                    <h4>Install TestFlight App</h4>
                    <p>Download and install TestFlight from the App Store (it's free). Search for "TestFlight" or visit: <a href="https://apps.apple.com/app/testflight/id899247664" target="_blank">TestFlight on App Store</a></p>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <h4>Open the Invitation Link</h4>
                    <p>Tap the "Download via TestFlight" button above, or use the invitation link provided by your administrator. This will open TestFlight automatically.</p>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <h4>Accept the Invitation</h4>
                    <p>In TestFlight, you'll see the MedWave app. Tap "Accept" to add it to your TestFlight apps, then tap "Install" to download MedWave to your device.</p>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <h4>Launch MedWave</h4>
                    <p>Once installed, you can open MedWave from your home screen like any other app. Sign in with your healthcare professional credentials to get started.</p>
                </div>

                <div class="step">
                    <span class="step-number">5</span>
                    <h4>Receive Updates</h4>
                    <p>When we release new versions, TestFlight will notify you. You can enable automatic updates in TestFlight settings to always have the latest version.</p>
                </div>

                <div class="warning">
                    <h4>‚ö†Ô∏è Important Notes</h4>
                    <ul>
                        <li>TestFlight builds expire after 90 days. You'll receive a notification to update before expiration.</li>
                        <li>You need an Apple ID to use TestFlight.</li>
                        <li>Make sure you're using the invitation link provided by MedWave administrators.</li>
                        <li>TestFlight apps are beta versions - report any issues to support.</li>
                    </ul>
                </div>
            </div>

            <!-- Android Instructions -->
            <div id="android-instructions" class="tab-content">
                <div class="warning">
                    <h4>‚ö†Ô∏è Before You Start</h4>
                    <ul>
                        <li>This app is distributed outside of Google Play Store</li>
                        <li>Only download from this official MedWave page</li>
                        <li>You'll need to enable "Install from Unknown Sources"</li>
                        <li>Disable this setting after installation for security</li>
                    </ul>
                </div>

                <div class="step">
                    <span class="step-number">1</span>
                    <h4>Download the APK File</h4>
                    <p>Tap the "Download APK" button above. Your browser will download the MedWave-v1.2.12.apk file (~65 MB). Wait for the download to complete.</p>
                </div>

                <div class="step">
                    <span class="step-number">2</span>
                    <h4>Enable Installation from Unknown Sources</h4>
                    <p><strong>For Android 8.0+ (Most Devices):</strong><br>
                    Open Settings ‚Üí Apps & notifications ‚Üí Special app access ‚Üí Install unknown apps ‚Üí Select your browser (Chrome, Firefox, etc.) ‚Üí Enable "Allow from this source"</p>
                    <p><strong>For Android 7.1 and Earlier:</strong><br>
                    Open Settings ‚Üí Security ‚Üí Enable "Unknown sources" ‚Üí Tap OK when prompted</p>
                </div>

                <div class="step">
                    <span class="step-number">3</span>
                    <h4>Install the APK</h4>
                    <p>Open your Downloads folder or tap the download notification. Tap the MedWave-v1.2.12.apk file, then tap "Install" when prompted. Wait for installation to complete.</p>
                </div>

                <div class="step">
                    <span class="step-number">4</span>
                    <h4>Disable Unknown Sources (Recommended)</h4>
                    <p>Return to Settings ‚Üí Security and disable "Unknown sources" or "Install unknown apps" for added security. This prevents accidental installation of other APKs.</p>
                </div>

                <div class="step">
                    <span class="step-number">5</span>
                    <h4>Launch MedWave</h4>
                    <p>Tap "Open" after installation, or find the MedWave icon in your app drawer. Grant required permissions (Camera, Storage) when prompted, then sign in with your credentials.</p>
                </div>

                <div class="info-box">
                    <h4>üí° Troubleshooting</h4>
                    <p><strong>Installation Failed?</strong> Ensure you have at least 200MB free storage and try restarting your device.</p>
                    <p><strong>App Won't Open?</strong> Check that your Android version is 5.0 or higher. Go to Settings ‚Üí Apps ‚Üí MedWave ‚Üí Storage ‚Üí Clear Cache if needed.</p>
                    <p><strong>Permission Issues?</strong> Go to Settings ‚Üí Apps ‚Üí MedWave ‚Üí Permissions and enable Camera and Storage access.</p>
                </div>

                <div class="warning">
                    <h4>üîÑ Updating to New Versions</h4>
                    <ul>
                        <li>You'll need to manually download and install new APK versions</li>
                        <li>You can install over the existing app - your data will be preserved</li>
                        <li>Check this page regularly for updates</li>
                        <li>Always verify the file size matches (~65 MB) before installing</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Security Notice -->
        <div class="instructions">
            <h3>üîí Security & Privacy</h3>
            <div class="step" style="border-left-color: #28a745;">
                <h4 style="color: #28a745;">‚úì Digitally Signed & Verified</h4>
                <p>This application is digitally signed and safe to install. MedWave uses enterprise-grade encryption (AES-256) to protect all patient data.</p>
            </div>
            <div class="step" style="border-left-color: #28a745;">
                <h4 style="color: #28a745;">‚úì HIPAA Compliant</h4>
                <p>MedWave is built for healthcare professionals and complies with HIPAA, POPIA, and GDPR regulations. All data is encrypted in transit and at rest.</p>
            </div>
            <div class="step" style="border-left-color: #28a745;">
                <h4 style="color: #28a745;">‚úì Professional Use Only</h4>
                <p>This application is designed exclusively for licensed healthcare professionals. Proper credentials are required for access.</p>
            </div>
        </div>

        <!-- Support Section -->
        <div class="instructions">
            <h3>üí¨ Need Help?</h3>
            <p style="font-size: 16px; color: #666; line-height: 1.8;">
                <strong>Having issues with installation or need support?</strong><br><br>
                üìß Email: <a href="mailto:support@medwave.com">support@medwave.com</a><br>
                üì± Include your device model, Android/iOS version, and screenshots of any errors<br>
                ‚è∞ We typically respond within 24 hours during business days
            </p>
        </div>

        <div class="footer">
            <p><strong>MedWave Provider</strong> - Advanced Wound Care Management</p>
            <p>¬© 2025 MedWave. All rights reserved.</p>
            <p style="font-size: 14px; margin-top: 16px;">
                <a href="../web/privacy-policy.html" style="color: white; text-decoration: underline;">Privacy Policy</a>
            </p>
        </div>
    </div>

    <!-- iOS TestFlight Request Modal -->
    <div id="iosModal" class="modal">
        <div class="modal-content" style="position: relative;">
            <button class="close-modal" onclick="closeIOSModal()">&times;</button>
            <div id="iosFormContent">
                <div class="modal-header">
                    <h2>üçé Request TestFlight Access</h2>
                    <p>Fill out the form below and we'll add you to our TestFlight beta program. You'll receive an email invitation within 24-48 hours with instructions on how to install the app.</p>
                </div>
                <form id="iosForm" onsubmit="submitIOSForm(event)">
                    <div class="form-group">
                        <label for="firstName">First Name *</label>
                        <input type="text" id="firstName" required>
                        <span class="error-message" id="firstNameError">Please enter your first name</span>
                    </div>
                    <div class="form-group">
                        <label for="lastName">Last Name *</label>
                        <input type="text" id="lastName" required>
                        <span class="error-message" id="lastNameError">Please enter your last name</span>
                    </div>
                    <div class="form-group">
                        <label for="contactNumber">Contact Number *</label>
                        <input type="tel" id="contactNumber" required>
                        <span class="error-message" id="contactNumberError">Please enter a valid contact number</span>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address *</label>
                        <input type="email" id="email" required>
                        <span class="error-message" id="emailError">Please enter a valid email address</span>
                    </div>
                    <div class="modal-actions">
                        <button type="button" class="modal-btn modal-btn-secondary" onclick="closeIOSModal()">Cancel</button>
                        <button type="submit" class="modal-btn modal-btn-primary" id="submitBtn">Submit Request</button>
                    </div>
                </form>
            </div>
            <div id="iosLoadingContent" class="loading">
                <div class="spinner"></div>
                <p>Submitting your request...</p>
            </div>
            <div id="iosSuccessContent" class="loading">
                <div class="success-message">
                    <div class="success-icon">‚úÖ</div>
                    <h3>Request Submitted!</h3>
                    <p>Thank you for your interest in MedWave. We'll review your request and send you a TestFlight invitation to your email within 24-48 hours.</p>
                    <p style="margin-top: 16px;"><strong>Check your email for the invitation link.</strong></p>
                    <button class="modal-btn modal-btn-primary" onclick="closeIOSModal()" style="margin-top: 24px; width: 100%;">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Android Download Instructions Modal -->
    <div id="androidModal" class="modal">
        <div class="modal-content" style="position: relative;">
            <button class="close-modal" onclick="closeAndroidModal()">&times;</button>
            <div class="modal-header">
                <h2>üì± Download MedWave APK</h2>
                <p>Before downloading, please read these important instructions for installing APK files on Android devices.</p>
            </div>
            <div class="warning">
                <h4>‚ö†Ô∏è Installation Requirements</h4>
                <ul>
                    <li>You'll need to enable "Install from Unknown Sources" on your device</li>
                    <li>Ensure you have at least 200MB of free storage space</li>
                    <li>Only download from this official MedWave page</li>
                    <li>The APK file is safe and digitally signed</li>
                </ul>
            </div>
            <div class="step">
                <h4>üìã Quick Installation Steps:</h4>
                <p>1. Tap "Continue to Download" below<br>
                2. Enable "Install from Unknown Sources" in your device settings<br>
                3. Open the downloaded APK file<br>
                4. Tap "Install" and wait for completion<br>
                5. Open MedWave and sign in</p>
            </div>
            <p style="color: #666; margin-top: 16px; font-size: 14px;">
                For detailed step-by-step instructions, scroll down to the "Installation Instructions" section after downloading.
            </p>
            <div class="modal-actions">
                <button type="button" class="modal-btn modal-btn-secondary" onclick="closeAndroidModal()">Cancel</button>
                <button type="button" class="modal-btn modal-btn-primary" onclick="downloadAndroidAPK()">Continue to Download</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBbL_DV9MEhpdU1uTTIL9_mY0bWEzl-xS4",
            authDomain: "medx-ai.firebaseapp.com",
            projectId: "medx-ai",
            storageBucket: "medx-ai.firebasestorage.app",
            messagingSenderId: "345960903635",
            appId: "1:345960903635:web:69df47e56abb65b4f79ac4",
            measurementId: "G-8KV9D9X13E"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // iOS TestFlight Form Functions
        function showIOSForm() {
            const modal = document.getElementById('iosModal');
            modal.classList.add('active');
            document.getElementById('iosFormContent').style.display = 'block';
            document.getElementById('iosLoadingContent').classList.remove('active');
            document.getElementById('iosSuccessContent').classList.remove('active');
        }

        function closeIOSModal() {
            const modal = document.getElementById('iosModal');
            modal.classList.remove('active');
            document.getElementById('iosForm').reset();
            // Clear any error messages
            document.querySelectorAll('.error-message').forEach(el => el.classList.remove('show'));
            document.querySelectorAll('input').forEach(el => el.classList.remove('error'));
        }

        async function submitIOSForm(event) {
            event.preventDefault();

            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();
            const contactNumber = document.getElementById('contactNumber').value.trim();
            const email = document.getElementById('email').value.trim();

            // Basic validation
            if (!firstName || !lastName || !contactNumber || !email) {
                alert('Please fill in all required fields');
                return;
            }

            // Show loading
            document.getElementById('iosFormContent').style.display = 'none';
            document.getElementById('iosLoadingContent').classList.add('active');
            document.getElementById('submitBtn').disabled = true;

            try {
                // Submit to Firestore
                await db.collection('testflight_requests').add({
                    firstName: firstName,
                    lastName: lastName,
                    contactNumber: contactNumber,
                    email: email,
                    status: 'pending',
                    requestedAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                // Show success message
                document.getElementById('iosLoadingContent').classList.remove('active');
                document.getElementById('iosSuccessContent').classList.add('active');
            } catch (error) {
                console.error('Error submitting form:', error);
                alert('Failed to submit request. Please try again or contact support.');
                document.getElementById('iosLoadingContent').classList.remove('active');
                document.getElementById('iosFormContent').style.display = 'block';
                document.getElementById('submitBtn').disabled = false;
            }
        }

        // Android Download Functions
        function showAndroidInstructions() {
            const modal = document.getElementById('androidModal');
            modal.classList.add('active');
        }

        function closeAndroidModal() {
            const modal = document.getElementById('androidModal');
            modal.classList.remove('active');
        }

        async function downloadAndroidAPK() {
            try {
                // Show loading state
                const downloadBtn = event.target;
                downloadBtn.disabled = true;
                downloadBtn.textContent = 'Preparing Download...';

                const fileName = 'MedWave-v1.2.12.apk';
                const downloadUrl = './MedWave-v1.2.12.apk';

                // Close modal
                closeAndroidModal();

                // Initiate download
                const link = document.createElement('a');
                link.href = downloadUrl;
                link.download = fileName;
                link.target = '_blank';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

                // Show success message
                alert(`Downloading ${fileName}...\n\nPlease check your Downloads folder and follow the installation instructions below.`);

                // Scroll to Android instructions
                const androidTab = document.querySelector('.tab:nth-child(2)');
                if (androidTab) {
                    androidTab.click();
                    document.getElementById('android-instructions').scrollIntoView({ behavior: 'smooth', block: 'start' });
                }

                // Re-enable button
                downloadBtn.disabled = false;
                downloadBtn.textContent = 'Continue to Download';
            } catch (error) {
                console.error('Download error:', error);
                alert('Failed to download APK. Please try again or contact support.');
                const downloadBtn = event.target;
                downloadBtn.disabled = false;
                downloadBtn.textContent = 'Continue to Download';
            }
        }

        // Tab switching function
        function showTab(tab) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected tab content
            document.getElementById(tab + '-instructions').classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const iosModal = document.getElementById('iosModal');
            const androidModal = document.getElementById('androidModal');
            
            if (event.target === iosModal) {
                closeIOSModal();
            }
            if (event.target === androidModal) {
                closeAndroidModal();
            }
        }
    </script>
</body>
</html>
