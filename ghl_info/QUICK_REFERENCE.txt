================================================================================
GHL OPPORTUNITY API - QUICK REFERENCE
================================================================================

üìç API ENDPOINT:
GET https://services.leadconnectorhq.com/opportunities/search

üîë HEADERS:
Authorization: Bearer pit-22f8af95-3244-41e7-9a52-22c87b166f5a
Version: 2021-07-28

üìä PARAMETERS:
location_id: QdLXaFEqrdF0JbVbpKLw
limit: 100
page: 1, 2, 3...

üéØ PIPELINE IDS:
Andries: XeAGJWRnUGJ5tuhXam2g
Davide: AUduOJBB2lxlsEaNmlJz

‚ö†Ô∏è  IMPORTANT: Use PAGE-BASED pagination, NOT cursor-based!
Correct: params = {'page': 1, 'limit': 100}
Wrong: params = {'startAfterId': cursor}

================================================================================
KEY OPPORTUNITY FIELDS
================================================================================

opportunity.id                         ‚Üí Opportunity ID
opportunity.name                       ‚Üí Contact name (e.g., "NADIA HARRIS")
opportunity.pipelineId                 ‚Üí Pipeline ID
opportunity.pipelineStageName          ‚Üí Stage name (e.g., "Deposit Received")
opportunity.monetaryValue              ‚Üí ‚≠ê CASH AMOUNT (e.g., 300000 = R 300,000)
opportunity.createdAt                  ‚Üí Timestamp

‚≠ê ATTRIBUTION FIELDS (for matching to Facebook ads):
opportunity.attributions[].utmAdId     ‚Üí Ad ID (TIER 1 - best, only 24%)
opportunity.attributions[].utmCampaignId ‚Üí Campaign ID (TIER 2 - good, 24%)
opportunity.attributions[].utmCampaign ‚Üí Ad Name (TIER 3 - ok, 18%)
opportunity.attributions[].utmMedium   ‚Üí AdSet Name (TIER 4 - last resort)

üìñ See MULTI_LEVEL_MATCHING_STRATEGY.md for complete matching guide

================================================================================
STAGE NAMES (Andries Pipeline)
================================================================================

‚úÖ "Deposit Received"  ‚Üê Use this, NOT "Deposit Paid"
‚úÖ "Cash Collected"
‚úÖ "Appointment Booked"
‚úÖ "New Lead"
‚úÖ "Paid"
‚úÖ "Completed"

================================================================================
PYTHON QUICK START
================================================================================

import requests

headers = {
    'Authorization': 'Bearer pit-22f8af95-3244-41e7-9a52-22c87b166f5a',
    'Version': '2021-07-28'
}

params = {
    'location_id': 'QdLXaFEqrdF0JbVbpKLw',
    'limit': 100,
    'page': 1
}

response = requests.get(
    'https://services.leadconnectorhq.com/opportunities/search',
    headers=headers,
    params=params
)

opportunities = response.json()['opportunities']

# Filter to Andries Pipeline
andries_opps = [
    o for o in opportunities 
    if o['pipelineId'] == 'XeAGJWRnUGJ5tuhXam2g'
]

# Get deposits
deposits = [
    o for o in andries_opps 
    if 'Deposit Received' in o['pipelineStageName']
]

# Extract data
for opp in deposits:
    print(f"{opp['name']}: R {opp['monetaryValue']:,.2f}")
    
    # Get Facebook Ad ID
    for attr in opp.get('attributions', []):
        if attr.get('h_ad_id'):
            print(f"  Ad ID: {attr['h_ad_id']}")

================================================================================

